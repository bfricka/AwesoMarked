// Generated by CoffeeScript 1.3.3
var MDProcessor, aMarked;

if (!(window.console && console.log)) {
  (function() {
    var console, len, methods, noop, _results;
    noop = function() {};
    methods = ['assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error', 'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log', 'markTimeline', 'profile', 'profileEnd', 'markTimeline', 'table', 'time', 'timeEnd', 'timeStamp', 'trace', 'warn'];
    len = methods.length;
    console = window.console = {};
    _results = [];
    while (len--) {
      _results.push(console[methods[len]] = noop);
    }
    return _results;
  })();
}

/* --------------------------------------------
     Begin app.coffee
--------------------------------------------
*/


MDProcessor = (function() {

  function MDProcessor(scope, elem, attrs) {
    this.scope = scope;
    this.elem = elem;
    this.attrs = attrs;
  }

  MDProcessor.prototype.matchers = [
    {
      tag: "h1",
      exp: /^(?:#{1}\s?)([^#]+)/i
    }, {
      tag: "h2",
      exp: /^(?:#{2}\s?)([^#]+)/i
    }, {
      tag: "h3",
      exp: /^(?:#{3}\s?)([^#]+)/i
    }, {
      tag: "h4",
      exp: /^(?:#{4}\s?)([^#]+)/i
    }, {
      tag: "h5",
      exp: /^(?:#{5}\s?)([^#]+)/i
    }, {
      tag: "h6",
      exp: /^(?:#{6}\s?)([^#]+)/i
    }, {
      tag: "ul",
      exp: /^(?:\*{1}\s?)([^*\r\n]+))/i
    }
  ];

  MDProcessor.prototype.process = function(md) {
    var lines, output, self;
    self = this;
    lines = md.split(/\n/gi);
    output = [];
    _.each(lines, function(line) {
      var markupMatches;
      if (line != null) {
        markupMatches = _.filter(self.matchers, function(matcher) {
          return matcher.exp.test(line) === true;
        });
        if ((markupMatches != null) && markupMatches.length) {
          return _.each(markupMatches, function(matcher) {
            var exp, str, tag;
            tag = matcher.tag;
            exp = matcher.exp;
            str = self.buildString(tag, exp, line);
            return output.push(str);
          });
        }
      }
    });
    console.log(output.join(''));
    this.scope.preview = output.join('');
    return console.log(lines);
  };

  MDProcessor.prototype.buildString = function(tag, exp, line) {
    var content, str;
    content = line.match(exp)[1];
    switch (tag) {
      case 'ul':
        return str = "<" + tag + "><li>" + content + "</li></" + tag + ">";
      default:
        return str = "<" + tag + ">" + content + "</" + tag + ">";
    }
  };

  return MDProcessor;

})();

aMarked = angular.module('aMarked', []);

/* --------------------------------------------
     Begin directives.coffee
--------------------------------------------
*/


aMarked.directive('markdownProcessor', function() {
  return {
    restrict: 'A',
    link: function(scope, elem, attrs) {
      var p;
      p = new MDProcessor(scope, elem, attrs);
      return scope.$watch('markdown', function(md) {
        return p.process(md);
      });
    }
  };
});

aMarked.directive('markdownPreview', function() {
  return {
    restrict: 'A',
    link: function(scope, elem, attrs) {
      return scope.$watch('preview', function(els) {
        return $(elem).empty().append(els);
      });
    }
  };
});

/* --------------------------------------------
     Begin filters.coffee
--------------------------------------------
*/


/* --------------------------------------------
     Begin services.coffee
--------------------------------------------
*/


/* --------------------------------------------
     Begin controllers.coffee
--------------------------------------------
*/


aMarked.controller('MainAppCtrl', [
  '$scope', function($scope) {
    $scope.title = "ng-Bootstrap";
    $scope.filename = "Untitled";
    $scope.markdown = '';
    return $scope.preview = '';
  }
]);
